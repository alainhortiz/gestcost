<?php

namespace AppBundle\Repository;

use Doctrine\ORM\EntityRepository;
use Exception;

/**
 * PlanRealRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PlanRealRepository extends EntityRepository
{
    public function cerrarRealMes($data)
    {
        try {
            $em = $this->getEntityManager();

            $realMes = $em->getRepository('AppBundle:PlanReal')->find($data['planReal']);

            if (!empty($realMes)) {

                switch ($data['mes']) {
                    case 'enero':
                        $realMes->setIsEnero(true);
                        break;
                    case 'febrero':
                        $realMes->setIsFebrero(true);
                        break;
                    case 'marzo':
                        $realMes->setIsMarzo(true);
                        break;
                    case 'abril':
                        $realMes->setIsAbril(true);
                        break;
                    case 'mayo':
                        $realMes->setIsMayo(true);
                        break;
                    case 'junio':
                        $realMes->setIsJunio(true);
                        break;
                    case 'julio':
                        $realMes->setIsJulio(true);
                        break;
                    case 'agosto':
                        $realMes->setIsAgosto(true);
                        break;
                    case 'septiembre':
                        $realMes->setIsSeptiembre(true);
                        break;
                    case 'octubre':
                        $realMes->setIsOctubre(true);
                        break;
                    case 'noviembre':
                        $realMes->setIsNoviembre(true);
                        break;
                    case 'diciembre':
                        $realMes->setIsDiciembre(true);
                        $realMes->setIsCerrado(true);
                        break;
                }

                $em->flush();
                $msg = $realMes;
            } else {
                $msg = $realMes;
            }

        } catch (Exception $e) {
            $msg = 'Se produjo un error al cerrar el real del mes ' . $data['mes'];
        }

        return $msg;
    }

}
